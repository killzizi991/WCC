<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, 
          maximum-scale=1.0, user-scalable=no, 
          viewport-fit=cover">
    <title>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø—Ä–æ–¥–∞–∂</title>
    <meta name="theme-color" content="#4a6cf7">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    
    <!-- PWA –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è -->
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="–ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø—Ä–æ–¥–∞–∂">
</head>
<body>
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="app-loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...</div>
    
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="header">
        <div class="header-container">
            <button id="prev-month">&lt;</button>
            <button id="month-year-selector" class="month-selector">
                <h2 id="current-month-year">–ò—é–ª—å 2025</h2>
            </button>
            <button id="next-month">&gt;</button>
            <button id="help-btn">?</button>
            <button id="settings-btn">‚öôÔ∏è</button>
        </div>
        
        <div class="tools-container">
            <button id="palette-btn" class="palette-btn">üé®</button>
            <button id="summary-btn">–û—Ç—á—ë—Ç</button>
            <button id="templates-btn">–®–∞–±–ª–æ–Ω—ã</button>
        </div>
    </div>
    
    <!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø–∞–ª–∏—Ç—Ä—ã -->
    <div id="palette-panel" class="palette-panel">
        <div class="palette-tools">
            <div class="palette-tool fill" data-color="#ffffff" style="background-color: #ffffff; border: 1px solid #e2e8f0;"></div>
            <div class="palette-tool fill" data-color="#bbdefb" style="background-color: #bbdefb;"></div>
            <div class="palette-tool fill" data-color="#c8e6c9" style="background-color: #c8e6c9;"></div>
            <div class="palette-tool fill" data-color="#b2ebf2" style="background-color: #b2ebf2;"></div>
            <div class="palette-tool fill" data-color="#fff9c4" style="background-color: #fff9c4;"></div>
            <div class="palette-tool fill" data-color="#e1bee7" style="background-color: #e1bee7;"></div>
            <div class="palette-tool fill" data-color="#f8bbd0" style="background-color: #f8bbd0;"></div>
            <div id="palette-border" class="palette-tool" title="–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ–±–≤–æ–¥–∫–∞">üî≤</div>
        </div>
    </div>
    
    <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
    <div id="calendar" class="calendar"></div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–î–µ–Ω—å <span id="modal-day"></span></h3>
            <div id="dynamic-fields">
                <!-- –ü–æ–ª—è –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –±–ª–æ–∫–æ–≤ -->
            </div>
            <textarea id="comment-input" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"></textarea>
            <div class="color-picker">
                <div class="color-option" style="background-color: #ffffff; border: 1px solid #e2e8f0;" data-color="#ffffff"></div>
                <div class="color-option" style="background-color: #bbdefb;" data-color="#bbdefb"></div>
                <div class="color-option" style="background-color: #c8e6c9;" data-color="#c8e6c9"></div>
                <div class="color-option" style="background-color: #b2ebf2;" data-color="#b2ebf2"></div>
                <div class="color-option" style="background-color: #fff9c4;" data-color="#fff9c4"></div>
                <div class="color-option" style="background-color: #e1bee7;" data-color="#e1bee7"></div>
                <div class="color-option" style="background-color: #f8bbd0;" data-color="#f8bbd0"></div>
            </div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–Ω—è -->
            <button id='day-settings-btn' style='margin-top: 10px; background: #6c757d;'>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–Ω—è</button>
            
            <!-- –ë–ª–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–Ω—è (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) -->
            <div id='day-settings' style='display: none; margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 5px;'>
                <h4>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —ç—Ç–æ–≥–æ –¥–Ω—è</h4>
                <div class='setting-group'>
                    <label>–ü—Ä–æ—Ü–µ–Ω—Ç —Å –ø—Ä–æ–¥–∞–∂ (%):</label>
                    <input type='number' id='day-sales-percent' min='0' max='100' step='0.1'>
                </div>
                <div class='setting-group'>
                    <label>–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã—Ö–æ–¥ (—Ä—É–±):</label>
                    <input type='number' id='day-shift-rate' min='0' step='100'>
                </div>
                <button id='reset-day-settings' style='background: #dc3545; margin-top: 10px;'>–°–±—Ä–æ—Å–∏—Ç—å –∫ –æ–±—â–∏–º</button>
            </div>
            
            <button id="save-data">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>
    
    <div id="summary-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–û—Ç—á—ë—Ç –∑–∞ <span id="summary-month-year">–ò—é–ª—å 2025</span></h3>
            <div class="summary-results">
                <p>–†–∞–±–æ—á–∏—Ö –¥–Ω–µ–π: <span id="modal-work-days">0</span></p>
                <p>–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –≤—Å–µ–≥–æ: <span id="modal-total-earned">0</span> —Ä—É–±</p>
                <p>–ó–∞—Ä–ø–ª–∞—Ç–∞: <span id="modal-salary">0</span> —Ä—É–±</p>
                <div id="advance-row" style="display: none;">
                    <p>–ê–≤–∞–Ω—Å: <span id="modal-advance">0</span> —Ä—É–±</p>
                </div>
            </div>
            <button id="detailed-data-btn">–ü–æ–¥—Ä–æ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
            <div id="detailed-data" style="display: none; margin-top: 15px;">
                <div id="total-sales-row" style="display: none;">
                    <p>–í—Å–µ–≥–æ –ø—Ä–æ–¥–∞–∂: <span id="modal-total-sales">0</span> —Ä—É–±</p>
                </div>
                <div id="day-hours-row" style="display: none;">
                    <p>–î–Ω–µ–≤–Ω—ã—Ö —á–∞—Å–æ–≤: <span id="modal-day-hours">0</span></p>
                </div>
                <div id="night-hours-row" style="display: none;">
                    <p>–ù–æ—á–Ω—ã—Ö —á–∞—Å–æ–≤: <span id="modal-night-hours">0</span></p>
                </div>
                <div id="total-hours-row" style="display: none;">
                    <p>–í—Å–µ–≥–æ —á–∞—Å–æ–≤: <span id="modal-total-hours">0</span></p>
                </div>
                <div id="day-shifts-row" style="display: none;">
                    <p>–î–Ω–µ–≤–Ω—ã—Ö —Å–º–µ–Ω: <span id="modal-day-shifts">0</span></p>
                </div>
                <div id="night-shifts-row" style="display: none;">
                    <p>–ù–æ—á–Ω—ã—Ö —Å–º–µ–Ω: <span id="modal-night-shifts">0</span></p>
                </div>
                <div id="total-shifts-row" style="display: none;">
                    <p>–í—Å–µ–≥–æ —Å–º–µ–Ω: <span id="modal-total-shifts">0</span></p>
                </div>
                <div id="overtime-row" style="display: none;">
                    <p>–°–≤–µ—Ä—Ö—É—Ä–æ—á–Ω—ã–µ: <span id="modal-overtime">0</span> —Ä—É–±</p>
                </div>
                <div id="bonus-row" style="display: none;">
                    <p>–°—É–º–º–∞ –±–æ–Ω—É—Å–∞: <span id="modal-bonus">0</span> —Ä—É–±</p>
                </div>
                <div id="deduction-row" style="display: none;">
                    <p>–°—É–º–º–∞ –≤—ã—á–µ—Ç–∞: <span id="modal-deduction">0</span> —Ä—É–±</p>
                </div>
                <div id="salary-before-bonuses-row" style="display: none;">
                    <p>–ó–∞—Ä–ø–ª–∞—Ç–∞ –¥–æ –±–æ–Ω—É—Å–æ–≤: <span id="modal-salary-before-bonuses">0</span> —Ä—É–±</p>
                </div>
                <div id="salary-before-deductions-row" style="display: none;">
                    <p>–ó–∞—Ä–ø–ª–∞—Ç–∞ –¥–æ –≤—ã—á–µ—Ç–æ–≤: <span id="modal-salary-before-deductions">0</span> —Ä—É–±</p>
                </div>
            </div>
            <button id="close-report" style="margin-top: 15px;">–ù–∞–∑–∞–¥</button>
        </div>
    </div>
    
    <div id="period-modal" class="modal">
        <div class="modal-content period-selector">
            <span class="close">&times;</span>
            <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥</h3>
            <div class="period-step" id="year-step">
                <h4>–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–¥</h4>
                <div class="period-options" id="year-options"></div>
            </div>
            <div class="period-step" id="month-step" style="display:none">
                <h4>–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—è—Ü</h4>
                <div class="period-options" id="month-options"></div>
            </div>
            <button id="period-back" style="display:none">‚Üê –ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å—á–µ—Ç–æ–≤</h3>
            
            <div class="setting-group" style="display: flex; gap: 10px; margin-top: 20px;">
                <button id="export-btn" style="flex: 1;">–≠–∫—Å–ø–æ—Ä—Ç</button>
                <button id="import-btn" style="flex: 1;">–ò–º–ø–æ—Ä—Ç</button>
            </div>

            <div class="setting-group" style="margin-top: 20px;">
                <button id="clear-all-data-btn" style="width: 100%; background: #dc3545;">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
            </div>

            <div class="setting-group" style="margin-top: 20px;">
                <button id="update-btn" style="width: 100%; background: #dc3545;">–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
            </div>
            
            <button id="save-settings">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —à–∞–±–ª–æ–Ω–æ–≤ -->
    <div id="templates-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="margin: 0; text-align: center; flex: 1;">–®–∞–±–ª–æ–Ω—ã</h3>
            </div>
            
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="position: relative; display: inline-flex; justify-content: center; align-items: center;">
                    <div id="current-template-name" style="font-weight: bold; font-size: 1.1em; cursor: pointer; margin-right: 10px;"></div>
                    <button id="edit-template-name" style="padding: 5px 10px;">‚úèÔ∏è</button>
                    <div id="template-dropdown" style="display: none; position: absolute; top: 100%; left: 0; background: white; border: 1px solid #ccc; z-index: 1000; width: 100%; max-height: 200px; overflow-y: auto;"></div>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <button id="add-rule-block" style="width: 100%;">–î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫ –ø—Ä–∞–≤–∏–ª</button>
                <div id="rule-blocks-list" style="margin-top: 10px;"></div>
            </div>

            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –æ–±–≤–æ–¥–∫–∏ -->
            <div id="functional-border-container" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                <h4 style="margin-bottom: 15px;">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –æ–±–≤–æ–¥–∫–∏</h4>
                <!-- –ü–æ–ª—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –æ–±–≤–æ–¥–∫–∏ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>

            <div style="margin-top: 20px;">
                <button id="clear-template-data-btn" style="width: 100%; background: #dc3545; margin-bottom: 10px;">–û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–≥–æ —à–∞–±–ª–æ–Ω–∞</button>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button id="save-template-changes" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                <button id="cancel-template-changes" style="flex: 1; background: #6c757d;">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–ª–æ–∫–æ–≤ –ø—Ä–∞–≤–∏–ª -->
    <div id="sales-percent-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —Å –ø—Ä–æ–¥–∞–∂</h3>
            <div id="sales-percent-ranges">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã -->
            </div>
            <button id="add-sales-range" style="margin: 10px 0;">+ –î–æ–±–∞–≤–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω</button>
            <div style="display: flex; gap: 10px;">
                <button id="save-sales-percent" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="close-block-modal" style="flex: 1; background: #6c757d;">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="shift-rate-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∞–≤–∫–∏ –∑–∞ —Å–º–µ–Ω—É</h3>
            <h4>–î–Ω–µ–≤–Ω—ã–µ —Å–º–µ–Ω—ã</h4>
            <div id="day-shift-ranges">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã -->
            </div>
            <button id="add-day-shift-range" style="margin: 10px 0;">+ –î–æ–±–∞–≤–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω</button>
            
            <h4>–ù–æ—á–Ω—ã–µ —Å–º–µ–Ω—ã</h4>
            <div id="night-shift-ranges">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã -->
            </div>
            <button id="add-night-shift-range" style="margin: 10px 0;">+ –î–æ–±–∞–≤–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω</button>
            
            <div style="display: flex; gap: 10px;">
                <button id="save-shift-rate" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="close-block-modal" style="flex: 1; background: #6c757d;">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="hourly-rate-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∞–≤–∫–∏ –∑–∞ —á–∞—Å</h3>
            <h4>–î–Ω–µ–≤–Ω—ã–µ —á–∞—Å—ã</h4>
            <div id="day-hourly-ranges">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã -->
            </div>
            <button id="add-day-hourly-range" style="margin: 10px 0;">+ –î–æ–±–∞–≤–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω</button>
            
            <h4>–ù–æ—á–Ω—ã–µ —á–∞—Å—ã</h4>
            <div id="night-hourly-ranges">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã -->
            </div>
            <button id="add-night-hourly-range" style="margin: 10px 0;">+ –î–æ–±–∞–≤–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω</button>
            
            <div style="display: flex; gap: 10px;">
                <button id="save-hourly-rate" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="close-block-modal" style="flex: 1; background: #6c757d;">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="advance-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤–∞–Ω—Å–∞</h3>
            <div class="setting-group">
                <label>–¢–∏–ø —Ä–∞—Å—á–µ—Ç–∞:</label>
                <select id="advance-type">
                    <option value="fixed">–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞</option>
                    <option value="percent">–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –∑–∞—Ä–∞–±–æ—Ç–∫–∞</option>
                </select>
            </div>
            <div class="setting-group" id="advance-fixed-container">
                <label>–°—É–º–º–∞ –∞–≤–∞–Ω—Å–∞ (—Ä—É–±):</label>
                <input type="number" id="advance-fixed" min="0" step="100">
            </div>
            <div class="setting-group" id="advance-percent-container" style="display: none;">
                <label>–ü—Ä–æ—Ü–µ–Ω—Ç –∞–≤–∞–Ω—Å–∞ (%):</label>
                <input type="number" id="advance-percent" min="0" max="100" step="1">
            </div>
            <div style="display: flex; gap: 10px;">
                <button id="save-advance" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="close-block-modal" style="flex: 1; background: #6c757d;">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="tax-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–ª–æ–≥–∞</h3>
            <div class="setting-group">
                <label>–ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–∞–ª–æ–≥–∞:</label>
                <select id="tax-source">
                    <option value="total">–°–æ –≤—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∫–∞</option>
                    <option value="fixed">–° —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—É–º–º—ã</option>
                </select>
            </div>
            <div class="setting-group">
                <label>–ü—Ä–æ—Ü–µ–Ω—Ç –Ω–∞–ª–æ–≥–∞ (%):</label>
                <input type="number" id="tax-percent" min="0" max="100" step="0.1">
            </div>
            <div class="setting-group" id="tax-fixed-container" style="display: none;">
                <label>–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –Ω–∞–ª–æ–≥–∞ (—Ä—É–±):</label>
                <input type="number" id="tax-fixed" min="0" step="100">
            </div>
            <div style="display: flex; gap: 10px;">
                <button id="save-tax" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="close-block-modal" style="flex: 1; background: #6c757d;">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="bonus-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ–Ω—É—Å–∞</h3>
            <div class="setting-group">
                <label>–°—É–º–º–∞ –±–æ–Ω—É—Å–∞ (—Ä—É–±):</label>
                <input type="number" id="bonus-amount" min="0" step="100">
            </div>
            <div style="display: flex; gap: 10px;">
                <button id="save-bonus" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="close-block-modal" style="flex: 1; background: #6c757d;">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="overtime-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–≤–µ—Ä—Ö—É—Ä–æ—á–Ω—ã—Ö</h3>
            <div class="setting-group">
                <label>–¢–∏–ø —Ä–∞—Å—á–µ—Ç–∞:</label>
                <select id="overtime-type">
                    <option value="shifts">–°–º–µ–Ω—ã</option>
                    <option value="hours">–ß–∞—Å—ã</option>
                </select>
            </div>
            <div class="setting-group">
                <label>–ü—Ä–µ–¥–µ–ª –¥–ª—è —Å–≤–µ—Ä—Ö—É—Ä–æ—á–Ω—ã—Ö:</label>
                <input type="number" id="overtime-limit" min="0" step="1">
            </div>
            <div class="setting-group">
                <label>–ú–Ω–æ–∂–∏—Ç–µ–ª—å —Å–≤–µ—Ä—Ö—É—Ä–æ—á–Ω—ã—Ö:</label>
                <input type="number" id="overtime-multiplier" min="1" step="0.1" value="1.5">
            </div>
            <div style="display: flex; gap: 10px;">
                <button id="save-overtime" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="close-block-modal" style="flex: 1; background: #6c757d;">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="fixed-deduction-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã—á–µ—Ç–∞</h3>
            <div class="setting-group">
                <label>–°—É–º–º–∞ –≤—ã—á–µ—Ç–∞ (—Ä—É–±):</label>
                <input type="number" id="deduction-amount" min="0" step="100">
            </div>
            <div style="display: flex; gap: 10px;">
                <button id="save-deduction" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="close-block-modal" style="flex: 1; background: #6c757d;">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ù–æ–≤—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞/–∏–º–ø–æ—Ä—Ç–∞ -->
    <div id="export-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
            <p id="ios-export-text" style="margin-bottom: 15px; display: none;">
                –ù–∞–∂–º–∏—Ç–µ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞. 
                –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤ –Ω–∞–¥–µ–∂–Ω–æ–º –º–µ—Å—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∑–∞–º–µ—Ç–∫–∞—Ö).
            </p>
            <div style="display: flex; gap: 10px;">
                <button id="copy-data-btn" style="flex: 1;">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                <button id="save-file-btn" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª</button>
            </div>
        </div>
    </div>

    <div id="import-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
            <textarea id="import-text-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞–∂–º–∏—Ç–µ '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å'" style="height: 120px; margin: 10px 0;"></textarea>
            <div style="display: flex; gap: 10px;">
                <button id="import-file-btn" style="flex: 1;">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</button>
                <button id="import-text-btn" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–º–æ—â–∏ -->
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h3>
            <div id="help-content" style="margin-top: 20px;"></div>
        </div>
    </div>

    <!-- –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ -->
    <input type="file" id="import-file" accept=".json" style="display: none;">

    <script src="help.js"></script>
    <script src="rules.js"></script>
    <script src="core.js"></script>
    <script src="calendar-manager.js"></script>
    <script src="templates-manager.js"></script>
    <script src="calculations-export.js"></script>
    <script src="event-handlers.js"></script>
    <script>
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ø—Ä–∏ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
        const SW_VERSION = 'v8';
        if (localStorage.getItem('sw_version') !== SW_VERSION) {
          caches.keys().then(cacheNames => {
            cacheNames.forEach(cacheName => caches.delete(cacheName));
          }).then(() => {
            localStorage.setItem('sw_version', SW_VERSION);
            console.log('–ö–µ—à –æ—á–∏—â–µ–Ω –¥–ª—è –≤–µ—Ä—Å–∏–∏', SW_VERSION);
          });
        }

        window.addEventListener('load', () => {
            document.getElementById('app-loading').style.display = 'none';
            
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.error('SW registration error:', err));
            }
        });
    </script>
</body>
</html>
